# RISC-V とは

これから実装を目指すオープンソースな命令セットアーキテクチャ (instruction set architecture: ISA) である RISC-V について、その概要と歴史について学びます。

## CISC と RISC

ISA の設計思想には大きく分けて Complex Instruction Set Computer (CISC) と Reduce Instruction Set Computer (RISC) の 2 種類があります。  
CISC は「複雑で高度な機能を持つ命令をなるべくたくさん用意する」([IT 用語辞典](https://e-words.jp/w/CISC.html)) ISA で、代表的なものに x86 や x86-64 があります。
CISC の命令は可変長で特定のフォーマットはなく、1 命令に複数の処理を詰め込んで高機能な命令を実装できるのが大きな特徴です。
一方で、命令のデコードが複雑化して回路規模が大きくなり、消費電力が大きくなるという短所があります。
また、命令ごとに処理クロック数が異なるためパイプライン化が難しい、プログラマの学習コストが高いなどのデメリットもあります。  
RISC は「固定長の単純な命令のみを備え、実行効率を向上させる」([IT 用語辞典](https://e-words.jp/w/RISC.html)) ことに主眼を置いた ISA で、ARM がその代表例と言えます。
RISC の命令は固定長で、いくつかのフォーマットに従って定義されているため、デコード回路を小型化し消費電力を低減することが可能です。
また、1 命令が 1 クロックで実行可能な単純な処理で構成されており、パイプライン化などの最適化を適用しやすく、また命令数が少ないのでプログラマが学習しやすいというメリットもあります。

|            |  CISC  |  RISC  |
| :--------: | :----: | :----: |
|  回路規模  | 大きい | 小さい |
|   命令長   |  長い  |  短い  |
|   命令数   |  多い  | 少ない |
|  処理時間  |  長い  |  短い  |
| 学習コスト | 大きい | 小さい |

こう書いてしまうと、CISC は良いところなしのように見えますが、CPU の歴史の中では伝統的に CISC の方が使われてきました。
コンピュータの普及当初コンパイラは存在せず、機械語やアセンブリ言語を使ってプログラミングをするのが一般的でした。
その場合、1 つの命令でより複雑な処理を実行できた方がプログラミングが楽になります。
また、メモリが非常に高価だったこともあり、プログラムメモリを削減するために、可変長で複雑な処理を実行可能な命令が求められていたという経緯もあるようです。
このように、1 命令に複数処理を詰め込むのは一般的な考え方であり、そもそも CISC vs RISC という構図自体、1980 年代までは存在しませんでした。  
しかし、命令が複雑化するにつれてハードウェアが大規模化し、開発期間が長期化するという問題が生じました。
また、回路規模の増大は、消費電力の増加や動作周波数の低下などの問題につながります。
そこで、1980 年代になると単純な命令を組み合わせて複雑な処理を実現する RISC が登場しました。
この頃には、半導体の高集積化・低価格化が進み安価に高速なメモリが入手できるようになっていたことや、パイプライン処理や分岐予測などの技術向上なども RISC の後押しとなります。
そして、ここで初めて RISC に対する既存概念として CISC という考え方が登場します。
RISC の登場当初、「RISC は CISC を超えるのか」ということが活発に議論され、追いつけ追い越せで様々な RISC プロセッサが発売されました。
しかし、2000 年代に入ると CISC プロセッサの中に RISC 的な要素を取り込んだり、RISC プロセッサでも様々な命令がサポートされるようになったりと、両者の境目は曖昧になり、CISC vs RISC という対立構造があまり意味をなさなくなりました。

## RISC-V の登場

先にも述べた通り、近年の動向として RISC と CISC の境目は曖昧で、RISC の代表格であった ARM 社の ISA も CISC 的性質を持つようになりました。
それでは、なぜ RISC-V が注目されているかというと、RISC-V がオープンソースであることがその大きな理由です。
これまで、ISA は CISC か RISC かによらず、営利企業が独占してきました。
たとえば、CISC の x86 や x86-64 系では Intel や AMD、RISC では Arm が挙げられます。
特に Arm は、NVIDIA による買収が取り沙汰され、その独立性や中立性が損なわれるのではないかと一時期大きな話題になりました。
結局、この話はイギリスやアメリカの政府から認可されず、買収は事実上たち消えになりましたが、今後このような問題が再燃しないとも限りません。  
一方、RISC-V はスイスを拠点に活動する非営利団体 RISC-V International が所有する ISA で、その仕様が商用利用が可能なライセンスで公開されています。
RISC-V という名称は、カリフォルニア大学バークレー校 (University of California, Berkeley) で開発された RISC ISA の 5 番目のメジャーバージョンという意味です。
カリフォルニア大学バークレー校では、1980 年代から RISC-I、RISC-II、SOAR、SPUR という 4 種類の RISC ISA が開発されていました。
その後、SPUR の登場から 20 年以上の時を経て、2010 年夏に 3 ヶ月をかけてスクラッチから開発された ISA が RISC-V です。
当初、この ISA は調停消費電力を指向する RAVEN-1 というチップのために開発されていたのですが、ハードウェア分野において Linux のような存在になることを目標としてオープンソース化されました。
